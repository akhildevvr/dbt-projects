/*

    We can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml


*/



with margin_variance as 
(
SELECT
* 
FROM EIO_PUBLISH.TENROX_PRIVATE.CUST_ADSK_MARGINVARIANCE
)

SELECT 
    PROJECTID as PROJECT_ID,
    PROJECTCODE as PROJECT_CODE,
    AC_PROJGOVERNANCE,
    AC_SE_NAME1,
    AC_SE_NAME2,
    ACCONTRACTTYPE as AC_CONTRACT_TYPE,
    ACCOUNTINGCONTRACTTYPE as ACCOUNTING_CONTRACT_TYPE,
    CS_DATE_ENGAGEMENT_SURVEY_SENT,
    CSMLEAD as CSM_LEAD,
    CUSTOMERNAME as CUSTOMER_NAME,
    DISPLAYEDCURRENCY as DISPLAYED_CURRENCY,
    EAC_COST,
    EAC_REVENUE,
    FINALWORKDATE as FINAL_WORKDATE,
    GEO,
    GEO2,
    GEODELIVERY as GEO_DELIVERY,
    ESCALATION_REASON,
    ESCALATION_STATUSANDACTION as ESCALATION_STATUS_AND_ACTION,
    GOVPMDOC_DELIVERY_MANAGER,
    GS_SERVICELINE,
    GS_SERVICELINE_PRIMARYPRODUCT,
    GS_SERVICELINE_PROJECTTYPE,
    GS_SERVICELINE_SUB_INDUSTRY,
    HRS_BOOKED,
    HRS_EAC,
    HRS_ETC,
    INITIALWORKDATE as INITIAL_WORKDATE,
    MARGINVARIANCECATEGORY as MARGIN_VARIANCE_CATEGORY,
    MARGINVARIANCEDESCRIPTION as MARGIN_VARIANCE_DESCRIPTION,
    PACKAGED_OFFERINGS,
    PLANCOST as PLAN_COST,
    PLANHOURS as PLAN_HOURS,
    PLANNED_END_DATE,
    PLANREVENUE as PLAN_REVENUE,
    PORTFOLIOMANAGER as PORTFOLIO_MANAGER,
    PORTFOLIONAME as PORTFOLIO_NAME,
    PRIORFYCOST as PRIOR_FY_COST,
    PROJECTCURRENCY as PROJECT_CURRENCY,
    PROJECTENDDATE as PROJECT_END_DATE,
    PROJECTMANAGEREEID as PROJECT_MANAGER_EEID,
    PROJECTMANAGERGEO as PROJECT_MANAGER_GEO,
    PROJECTMANAGERNAME as PROJECT_MANAGER_NAME,
    PROJECTNAME as PROJECT_NAME,
    PROJECTSTARTDATE as PROJECT_START_DATE,
    PROJECTSTATE as PROJECT_STATE,
    PROJECTTYPE as PROJECT_TYPE,
    PROJHEALTH_CUSTOMER,
    PROJHEALTH_OVERALL,
    PROJHEALTH_QUALITY,
    PROJHEALTH_RESOURCE,
    PROJHEALTH_SCHEDULE,
    REVRECTREATMENT,
    ROWNUMBER,
    SQLSCRIPTVERSION,
    TENROXTRACKINGNO as TENROX_TRACKING_NO,
    TIMECATEGORY as TIME_CATEGORY,
    WASNEWTABLE
FROM
    margin_variance