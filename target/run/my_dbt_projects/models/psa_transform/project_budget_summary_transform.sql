
  create or replace   view EIO_INGEST.ENGAGEMENT_TRANSFORM.project_budget_summary
  
   as (
    /*

    We can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml


*/



 SELECT        PROJBUDGET.OBJECTID AS Project_Unique_Id,
       PROJBUDGET.BUDGETLISTNAME AS Project_Budget,
       PROJBUDGET.BUDGETLISTSTARTDATE AS Project_Budget_Start,
                         PROJBUDGET.BUDGETLISTENDDATE AS Project_Budget_End,
       COALESCE(PROJBUDGET.BUDGETLISTDESC, '') AS Project_Budget_Description,
       PROJBUDGET.BUDGETCURRENTTIME / 3600.00 AS Project_Budget_Current_Time,
                         PROJBUDGET.BUDGETBASELINETIME / 3600.00 AS Project_Budget_Baseline_Time,
                         PROJBUDGET.BUDGETCURRENTBILLABLETIME / 3600.00 AS Project_Budget_Current_Billable_Time,
       PROJBUDGET.BUDGETBASELINEBILLABLETIME / 3600.00 AS Project_Budget_Baseline_Billable_Time,


       PROJBUDGET.BUDGETCURRENTNONBILLABLETIME / 3600.00 AS Project_Budget_Current_Non_Billable_Time,
                         PROJBUDGET.BUDGETBASELINENONBILLABLETIME / 3600.00 AS Project_Budget_Baseline_Non_Billable_Time,


                         PROJBUDGET.BUDGETCURRENTCOSTPROJCOSTCURRENCY AS Project_Budget_Current_Cost_In_Project_Cost_Curr,
       PROJBUDGET.BUDGETCURRENTCOSTBASECURRENCY AS Project_Budget_Current_Cost_In_Base_Curr,
                         PROJBUDGET.BUDGETBASELINECOSTPROJCOSTCURRENCY AS Project_Budget_Baseline_Cost_In_Project_Cost_Curr,
                         PROJBUDGET.BUDGETBASELINECOSTBASECURRENCY AS Project_Budget_Baseline_Cost_In_Base_Curr
FROM            (SELECT        TBUDGETDETAIL.OBJECTID, TBUDGETDETAIL.OBJECTTYPE, TBUDGETDETAIL.COSTCURRENCYID, TBUDGETDETAIL.BILLCURRENCYID, TBUDGETDETAILLIST.UNIQUEID AS BUDGETLISTUID,
                         TBUDGETDETAILLIST.NAME AS BUDGETLISTNAME, TBUDGETDETAILLIST.STARTDATE AS BUDGETLISTSTARTDATE, TBUDGETDETAILLIST.ENDDATE AS BUDGETLISTENDDATE,
                         TBUDGETDETAILLIST.DESCRIPTION AS BUDGETLISTDESC, TBUDGETDETAILLIST.RATECOSTTOBASECUR, TBUDGETDETAILLIST.RATEBILLTOBASECUR AS RATETOCBILLCUR,
                         TBUDGETDETAILLIST.RATETOCOSTCUR, TBUDGETDETAILLIST.RATETOBILLCUR, COUNT(*) AS NUMBER, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTTIME, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINETIME, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTBILLABLETIME, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEBILLABLETIME, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTNONBILLABLETIME,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 1 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0))
                         AS BUDGETBASELINENONBILLABLETIME, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTCOSTPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINECOSTPROJCOSTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTCOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTCOSTPROJTIMECOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINECOSTPROJTIMECOSTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTTIMECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINETIMECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSECOSTPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEEXPENSECOSTPROJCOSTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEEXPENSECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTCHARGECOSTPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINECHARGECOSTPROJCOSTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTCHARGECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINECHARGECOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTCOSTPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEPRODUCTCOSTPROJCOSTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTCOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 2 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEPRODUCTCOSTBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0))
                         AS BUDGETCURRENTBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTTIMEBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINETIMEBILLABLECLIENTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTTIMEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINETIMEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSEBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEEXPENSEBILLABLECLIENTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEEXPENSEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTCHARGEBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINECHARGEBILLABLECLIENTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTCHARGEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINECHARGEBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTBILLABLECLIENTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINEPRODUCTBILLABLECLIENTCURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 3 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATEBILLTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEPRODUCTBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0))
                         AS BUDGETCURRENTNONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0)) AS BUDGETBASELINENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTNONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTTIMENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0))
                         AS BUDGETBASELINETIMENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTTIMENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 4 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINETIMENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0))
                         AS BUDGETBASELINEEXPENSENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTEXPENSENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 1 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEEXPENSENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTCHARGENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0))
                         AS BUDGETBASELINECHARGENONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTCHARGENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 2 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINECHARGENONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTNONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE ELSE 0 END, 0))
                         AS BUDGETBASELINEPRODUCTNONBILLABLEPROJCOSTCURRENCY, SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.CURRENTVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETCURRENTPRODUCTNONBILLABLEBASECURRENCY,
                         SUM(COALESCE(CASE WHEN TBUDGETDETAILENTRY.ENTRYTYPE = 4 AND TBUDGETDETAILENTRY.ENTRYSUBTYPE = 3 AND TBUDGETDETAILENTRY.OBJECTID IS NULL THEN TBUDGETDETAILENTRY.BASELINEVALUE * TBUDGETDETAILLIST.RATECOSTTOBASECUR ELSE 0 END, 0)) AS BUDGETBASELINEPRODUCTNONBILLABLEBASECURRENCY
FROM           EIO_PUBLISH.TENROX_PRIVATE.TBUDGETDETAILENTRY as TBUDGETDETAILENTRY INNER JOIN
                        EIO_PUBLISH.TENROX_PRIVATE.TBUDGETDETAILLIST as TBUDGETDETAILLIST ON TBUDGETDETAILLIST.UNIQUEID = TBUDGETDETAILENTRY.BUDGETDETAILEDLISTID INNER JOIN
                        EIO_PUBLISH.TENROX_PRIVATE.TBUDGETDETAIL as TBUDGETDETAIL ON TBUDGETDETAIL.UNIQUEID = TBUDGETDETAILLIST.BUDGETDETAILEDID
GROUP BY TBUDGETDETAIL.OBJECTID, TBUDGETDETAIL.OBJECTTYPE, TBUDGETDETAIL.COSTCURRENCYID, TBUDGETDETAILLIST.UNIQUEID, TBUDGETDETAILLIST.NAME, TBUDGETDETAILLIST.STARTDATE,
                         TBUDGETDETAILLIST.ENDDATE, TBUDGETDETAILLIST.DESCRIPTION, TBUDGETDETAILLIST.STARTDATE, TBUDGETDETAILLIST.ENDDATE, TBUDGETDETAILLIST.RATECOSTTOBASECUR,
                         TBUDGETDETAILLIST.RATETOCOSTCUR, TBUDGETDETAILLIST.RATEBILLTOBASECUR, TBUDGETDETAIL.BILLCURRENCYID, TBUDGETDETAILLIST.RATETOBILLCUR) AS PROJBUDGET


WHERE        (PROJBUDGET.OBJECTTYPE = 2)
GROUP BY PROJBUDGET.OBJECTID, PROJBUDGET.BUDGETLISTNAME, PROJBUDGET.BUDGETLISTSTARTDATE, PROJBUDGET.BUDGETLISTENDDATE, PROJBUDGET.BUDGETLISTDESC, PROJBUDGET.BUDGETCURRENTTIME,
                         PROJBUDGET.BUDGETBASELINETIME, PROJBUDGET.BUDGETCURRENTBILLABLETIME, PROJBUDGET.BUDGETBASELINEBILLABLETIME, PROJBUDGET.BUDGETCURRENTNONBILLABLETIME,
                         PROJBUDGET.BUDGETBASELINENONBILLABLETIME, PROJBUDGET.BUDGETCURRENTCOSTPROJCOSTCURRENCY, PROJBUDGET.BUDGETBASELINECOSTPROJCOSTCURRENCY,
                         PROJBUDGET.BUDGETCURRENTCOSTBASECURRENCY, PROJBUDGET.BUDGETBASELINECOSTBASECURRENCY, PROJBUDGET.BUDGETCURRENTBILLABLECLIENTCURRENCY
  );

