begin;
    
        
            delete from ADP_WORKSPACES.CUSTOMER_SUCCESS_SHARED.tflex_usage_dd_fct_snapshot
            where (
                run_date) in (
                select (run_date)
                from ADP_WORKSPACES.CUSTOMER_SUCCESS_SHARED.tflex_usage_dd_fct_snapshot__dbt_tmp
            );

        
    

    insert into ADP_WORKSPACES.CUSTOMER_SUCCESS_SHARED.tflex_usage_dd_fct_snapshot ("RUN_DATE", "DT", "ULTIMATE_PARENT_ACCOUNT_NAME", "ULTIMATE_PARENT_ACCOUNT_CSN", "ULTIMATE_PARENT_ECA_NAME", "ACCOUNT_NAME", "ACCOUNT_CSN", "AGREEMENT_ID", "TFLEX_REPORTING_PLATFORM", "EXHIBIT_ID", "EXHIBIT_START_DATE", "EXHIBIT_END_DATE", "EXHIBIT_NAME", "EBA_ANALYTICS_NAME_KEY", "USAGE_YEAR", "USAGE_MONTH", "TXN_TYPE_NM", "BYMONTH", "DISTINCT_PRODUCTS", "DISTINCT_USERS", "MINUTES", "HOURS", "TOKENS", "MULTI_YEAR_TOKENS", "ANNUAL_TOKENS", "TOKENS_CONSUMED", "TOKENS_ADJUSTED")
    (
        select "RUN_DATE", "DT", "ULTIMATE_PARENT_ACCOUNT_NAME", "ULTIMATE_PARENT_ACCOUNT_CSN", "ULTIMATE_PARENT_ECA_NAME", "ACCOUNT_NAME", "ACCOUNT_CSN", "AGREEMENT_ID", "TFLEX_REPORTING_PLATFORM", "EXHIBIT_ID", "EXHIBIT_START_DATE", "EXHIBIT_END_DATE", "EXHIBIT_NAME", "EBA_ANALYTICS_NAME_KEY", "USAGE_YEAR", "USAGE_MONTH", "TXN_TYPE_NM", "BYMONTH", "DISTINCT_PRODUCTS", "DISTINCT_USERS", "MINUTES", "HOURS", "TOKENS", "MULTI_YEAR_TOKENS", "ANNUAL_TOKENS", "TOKENS_CONSUMED", "TOKENS_ADJUSTED"
        from ADP_WORKSPACES.CUSTOMER_SUCCESS_SHARED.tflex_usage_dd_fct_snapshot__dbt_tmp
    );
    commit;